---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import ServiceGrid from '../components/ServiceGrid.astro';
import ProcessSection from '../components/ProcessSection.astro';
import DifferentialsSection from '../components/DifferentialsSection.astro';
import PricingSection from '../components/PricingSection.astro';
import FAQSection from '../components/FAQSection.astro';
import ContactSection from '../components/ContactSection.astro';
---

<Layout>
	<main>
		<!-- Hero: Primeira impressão com CTA -->
		<Hero />

		<!-- Serviços: O que ofereço -->
		<ServiceGrid />

		<!-- Processo: Como funciona (O Plano de Voo) -->
		<ProcessSection />

		<!-- Diferenciais: Por que me escolher -->
		<DifferentialsSection />

		<!-- Preços: Pacotes e valores -->
		<PricingSection />

		<!-- FAQ: Dúvidas frequentes -->
		<FAQSection />

		<!-- Contato: CTA final -->
		<ContactSection />
	</main>

  <!-- Umami: tracking script para capturar UTMs e atualizar campaign parameter -->
  <script>
    (function(){
      if (!window.umami) return;
      try {
        const params = Object.fromEntries(new URLSearchParams(window.location.search));
        // envia landing_view com UTMs para o Umami
        window.umami.track && window.umami.track('landing_view', params);
        const utmCampaign = params.utm_campaign || null;
        if (utmCampaign) {
          document.querySelectorAll('a[data-umami-event="whatsapp_click"]').forEach(a => {
            try {
              const current = a.getAttribute('data-umami-props');
              const obj = current ? JSON.parse(current) : {};
              obj.campaign = utmCampaign;
              a.setAttribute('data-umami-props', JSON.stringify(obj));
            } catch (e) { /* ignorar erros de parse */ }
          });
        }
      } catch (e) { console.warn('Umami tracking init failed', e); }
    })();
  </script>
</Layout>
